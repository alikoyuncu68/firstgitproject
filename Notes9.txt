This is the code in my  ali_sprint10_lion branch